Spyre
=========

Spyre is Web Application Framework for providing a simple user interface for Python data projects.


Requirements
----
Spyre runs on the minimalist python web framework, **[cherrypy]**, with **[jinja2]** templating. At it's heart, spyre is about data and data visualization, so you'll also need **[pandas]** and **[matplotlib]**.


Installation
----
```
    $ pip install dataspyre
```


The Simplest of Examples
----
Here's a very simple spyre example to showcase the primary components of a spyre app
```
from spyre import server

import matplotlib.pyplot as plt
import numpy as np
from numpy import pi

class SimpleSineLaunch(server.Launch):
	templateVars = {"title" : "Simple Sine Wave",
					"inputs" : [{   "input_type":'text',
									"label": 'Frequency', 
									"value" : 5,
									"variable_name": 'freq', 
								}],
					"controls" : [{ "control_type" : "button",
									"control_id" : "button1",
									"label" : "plot",
								}],
					"outputs" : [{ "output_type" : "image",
									"output_id" : "plot",
									"control_id" : "button1",
									"on_page_load" : "true",
								}]
				}

	def getPlot(self, params):
		f = float(params['freq'])
		x = np.arange(0,6*pi,pi/50)
		y = np.sin(f*x/(2*pi))
		fig = plt.figure()
		splt1 = fig.add_subplot(1,1,1)
		splt1.plot(x,y)  # sine wave
		return fig

launcher = SimpleSineLaunch()
launcher.launch(port=9095)
```
The SimpleSineLauncher inherits server.Launch which includes a few methods that you can override depending on your app. In this case we want our app to display a Plot so we'll overide the getPlot method. This method should return a matplotlib figure.

We also need to define a dictionary named templateVars, which will be responsible for generating all of the html and javascript for our app.  All apps have three main user-facing components:
* inputs 
* controls
* outputs

which are all defined by the templateVars dictionary.

### inputs ###
This is a list of input dictionaries. In our simple example above, there's only one input, of type "text". We give it a label and initial value with the keys "label" and "value".  The value from this input will be used to generate an output (a plot in this case), so we need to also give it a variable_name.

### controls ###
Controls are the front-end components that generate/update the outputs. This too is a list of dictionaries. As with inputs, we must specify the control_type and give a label. Additionally, we'll provide a control_id, which is used to link this button to an output.

### outputs ###
Outputs are things like images (plots), tables, or text. In addition to output_type, we also need to provide a unique output_id. If this output gets generated by one of the controls specified in the list of controls, we need to also specify the control_id of that controller. In the case of our simple example, pressing the button (with control_id="button1") generates our plot so we provide that button's control_id here. If we want this output to load on the page load, we can also set "on_page_load" to "true" (this is false by default).

### generating a plot ###
Let's get back to our getPlot method. Notice that it takes a single argument: params. params is a dictionary containing:
1. all of the input values (with key equal to the variable_name specified in the input dictionary)
2. the output_id for the output being created.

For this simple example you can ignore the output_id (it'll be useful when defining multiple outputs of the same type). The value of each of the params is a string. In this example our one input variable represents a frequency, which is a number, so we'll need to cast it as a float before we use it.  The matplotlib figure returned by getPlot will be displayed in the right panel of our Spyre app.

### launching the app ###
That's all there is to it. To launch our app we just need to create an instance of our SimpleSineLaunch class and call the launch method. The launch method takes to optional parameters: host and port. By default, apps are served locally on port 8080. Set host='0.0.0.0' to serve your app to external traffic.

Assuming you name this file "simple_sine_example.py" you can launch this app from the command line with:
```
> python simple_sine_example.py
```
The output will indicate where the app is being served (usually something like http://127.0.0.1:9095)



License
----

MIT


[cherrypy]:http://docs.cherrypy.org/en/latest/install.html
[jinja2]:http://jinja.pocoo.org/docs/dev/intro/#installation
[pandas]:http://pandas.pydata.org/pandas-docs/stable/install.html#recommended-dependencies
[matplotlib]:http://matplotlib.org/users/installing.html

